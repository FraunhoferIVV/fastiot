# This file has been autogenerated. It is highly recommended to not edit it directly.
# Instead, if you need to do customizations, please consider using a "docker-compose.override.yaml" file.

version: "2.4"

{% if environment_for_docker_compose_file|length > 0 %}
x-env: &env_var
{% for item in environment_for_docker_compose_file %}
  {{item}}: "{{environment_for_docker_compose_file[item]}}"
{% endfor %}

{% endif %}
x-logging: &logging_var
  logging:
    driver: "json-file"
    options:
      max-size: "50m"
      max-file: "10"

services:
{% for infrastructure_service in infrastructure_services %}
  {{ infrastructure_service.name }}:
    image: "{{ infrastructure_service.image }}"
{% if infrastructure_service.environment|length > 0 or environment_for_docker_compose_file|length > 0 %}
    environment:
{% if environment_for_docker_compose_file|length > 0 %}
      <<: *env_var
{% endif %}
{% for item in infrastructure_service.environment %}
      {{item}}: "{{infrastructure_service.environment[item]}}"
{% endfor %}
{% endif %}
{% if infrastructure_service.ports|length > 0 %}
    ports:
{% for item in infrastructure_service.ports %}
      - "{{ item }}"
{% endfor %}
{% endif %}
{% if infrastructure_service.volumes|length > 0 %}
    volumes:
{% for item in infrastructure_service.volumes %}
      - "{{ item }}"
{% endfor %}
{% endif %}
    networks:
      - "{{ docker_net_name }}"
    restart: always

{% endfor %}
networks:
  {{ docker_net_name }}:
